# ğŸ—ï¸ ä¸‰æœåŠ¡å™¨åˆ†ç¦»æ¶æ„è®¾è®¡

## ğŸ“‹ æ¶æ„æ¦‚è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ç”¨æˆ·/æœç´¢å¼•æ“                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   æœåŠ¡å™¨ 2: è·³è½¬é¡µæœåŠ¡å™¨      â”‚
         â”‚   (ä¸­é—´å±‚/æµé‡åˆ†å‘)            â”‚
         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
         â”‚ â€¢ Linkè·³è½¬è·¯ç”±                 â”‚
         â”‚ â€¢ éšè—çœŸå®ç»“æ„                 â”‚
         â”‚ â€¢ è®¿é—®è¿‡æ»¤                     â”‚
         â”‚ â€¢ å¹²å‡€çš„SEOå¼•å¯¼                â”‚
         â”‚ â€¢ IPç™½åå•/é»‘åå•              â”‚
         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚                â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”         â”‚
      â”‚  å…¬å¼€åŸŸåè®¿é—®  â”‚         â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜         â”‚
                â”‚                â”‚
                â–¼                â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ æœåŠ¡å™¨ 1:          â”‚  â”‚ æœåŠ¡å™¨ 3:            â”‚
   â”‚ ç½‘é¡µæ¨¡æ¿æœåŠ¡å™¨      â”‚  â”‚ ç®¡ç†æœåŠ¡å™¨           â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚ â€¢ Website-1        â”‚  â”‚ â€¢ Adminåå°          â”‚
   â”‚ â€¢ Website-2        â”‚  â”‚ â€¢ èœ˜è››æ± ç³»ç»Ÿ         â”‚
   â”‚ â€¢ Website-TG       â”‚  â”‚ â€¢ PostgreSQLæ•°æ®åº“   â”‚
   â”‚ â€¢ 15ä¸ªå…¬å¼€åŸŸå     â”‚  â”‚ â€¢ ä»…å†…ç½‘/VPNè®¿é—®     â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ–¥ï¸ æœåŠ¡å™¨ 1: ç½‘é¡µæ¨¡æ¿æœåŠ¡å™¨

### ç”¨é€”
ä¸“é—¨éƒ¨ç½²3ä¸ªç½‘é¡µæ¨¡æ¿ï¼Œæ”¯æŒå¤šåŸŸåè®¿é—®ï¼Œé¢å‘å…¬ä¼—å’Œæœç´¢å¼•æ“ã€‚

### é…ç½®è¦æ±‚
- **CPU**: 2æ ¸å¿ƒ
- **å†…å­˜**: 4GB
- **ç¡¬ç›˜**: 50GB SSD
- **å¸¦å®½**: 5Mbps+
- **IP**: å…¬ç½‘ç‹¬ç«‹IP

### éƒ¨ç½²åº”ç”¨
```
apps/website-1   â†’ ç«¯å£ 3001
apps/website-2   â†’ ç«¯å£ 3002
apps/website-tg  â†’ ç«¯å£ 3003
```

### åŸŸååˆ†é… (15ä¸ªåŸŸå)
```
Website-1 (5ä¸ªåŸŸå):
- telegram1688.com
- telegram-cn.com
- telegram-download.net
- telegramapp.net
- telegram-app.org

Website-2 (5ä¸ªåŸŸå):
- telegramjiaoyu.com
- telegram-download.org
- telegramcn.net
- telegram-cn.org
- telegram-app.net

Website-TG (5ä¸ªåŸŸå):
- telegramzhfw.com
- telegram-ios.com
- telegram-android.com
- telegram-web.com
- telegram-pc.com
```

### ç¯å¢ƒå˜é‡ (.env.production)
```bash
# Nodeç¯å¢ƒ
NODE_ENV=production

# APIç«¯ç‚¹ (æŒ‡å‘æœåŠ¡å™¨3çš„å†…ç½‘åœ°å€)
NEXT_PUBLIC_API_URL=http://å†…ç½‘IP:3100/api

# æ•°æ®åº“ (åªè¯»å‰¯æœ¬æˆ–é€šè¿‡APIè®¿é—®)
DATABASE_URL="postgresql://readonly_user:password@å†…ç½‘IP:5432/seo_websites"

# ç½‘ç«™URL (æœ¬æœåŠ¡å™¨)
NEXT_PUBLIC_WEBSITE1_URL=https://telegram1688.com
NEXT_PUBLIC_WEBSITE2_URL=https://telegramjiaoyu.com
NEXT_PUBLIC_WEBSITE_TG_URL=https://telegramzhfw.com

# ç¦ç”¨æ•æ„ŸåŠŸèƒ½
DISABLE_ADMIN_ACCESS=true
```

### Nginxé…ç½®ç‰¹ç‚¹
- ä»…å¤„ç†é™æ€èµ„æºå’Œåå‘ä»£ç†
- å¯ç”¨ç¼“å­˜
- å¯ç”¨Gzipå‹ç¼©
- æ·»åŠ å®‰å…¨å¤´

---

## ğŸ”€ æœåŠ¡å™¨ 2: è·³è½¬é¡µæœåŠ¡å™¨ (ä¸­é—´å±‚)

### ç”¨é€”
è´Ÿè´£æµé‡åˆ†å‘ã€è®¿é—®è¿‡æ»¤ã€SEOå¼•å¯¼ã€éšè—çœŸå®æœåŠ¡å™¨ç»“æ„ã€‚

### é…ç½®è¦æ±‚
- **CPU**: 1æ ¸å¿ƒ
- **å†…å­˜**: 2GB
- **ç¡¬ç›˜**: 20GB SSD
- **å¸¦å®½**: 3Mbps+
- **IP**: å…¬ç½‘ç‹¬ç«‹IP (ä¸åŒäºæœåŠ¡å™¨1)

### æ ¸å¿ƒåŠŸèƒ½

#### 1. Linkè·³è½¬è·¯ç”±
```
ç”¨æˆ·è®¿é—®: https://jump.example.com/go/telegram
â†“
302é‡å®šå‘åˆ°: https://telegram1688.com
```

#### 2. éšè—çœŸå®ç»“æ„
```
å¯¹å¤–å±•ç¤º: https://t.me/s/channel
å®é™…æŒ‡å‘: https://å†…éƒ¨çœŸå®åœ°å€ï¼ˆé€šè¿‡ä»£ç†ï¼‰
```

#### 3. è®¿é—®è¿‡æ»¤
- IPç™½åå•/é»‘åå•
- User-Agentè¿‡æ»¤ï¼ˆè¯†åˆ«æœç´¢å¼•æ“ï¼‰
- åœ°åŒºè¿‡æ»¤ï¼ˆGeoIPï¼‰
- é¢‘ç‡é™åˆ¶ï¼ˆé˜²çˆ¬è™«ï¼‰

#### 4. SEOå¼•å¯¼
- ä¸ºæœç´¢å¼•æ“å±•ç¤ºä¼˜åŒ–çš„é¡µé¢
- ä¸ºæ™®é€šç”¨æˆ·å±•ç¤ºè·³è½¬é¡µ
- è®°å½•è®¿é—®ç»Ÿè®¡

### æŠ€æœ¯æ–¹æ¡ˆé€‰æ‹©

#### æ–¹æ¡ˆA: Nginx + Lua (æ¨èï¼Œæ€§èƒ½æœ€é«˜)
```nginx
# è·³è½¬è·¯ç”±
location /go/ {
    # æ ¹æ®è·¯å¾„å‚æ•°è·³è½¬
    rewrite ^/go/telegram1$ https://telegram1688.com permanent;
    rewrite ^/go/telegram2$ https://telegramjiaoyu.com permanent;
    rewrite ^/go/telegramtg$ https://telegramzhfw.com permanent;
}

# SEOå¼•å¯¼ - æœç´¢å¼•æ“çœ‹åˆ°ä¼˜åŒ–å†…å®¹
location / {
    if ($http_user_agent ~* "Googlebot|bingbot|Baiduspider") {
        proxy_pass http://æœåŠ¡å™¨1:3001;
    }
    # æ™®é€šç”¨æˆ·çœ‹åˆ°è·³è½¬é¡µ
    return 302 https://telegram1688.com;
}

# è®¿é—®è¿‡æ»¤
location /protected/ {
    # IPç™½åå•
    allow 1.2.3.4;  # ç®¡ç†å‘˜IP
    deny all;

    proxy_pass http://æœåŠ¡å™¨3:3100;
}
```

#### æ–¹æ¡ˆB: ç®€å•Node.jsåº”ç”¨
åˆ›å»ºä¸€ä¸ªè½»é‡çº§Expressåº”ç”¨ï¼š
```javascript
const express = require('express');
const app = express();

// è·³è½¬è·¯ç”±
const redirectMap = {
  '/go/telegram1': 'https://telegram1688.com',
  '/go/telegram2': 'https://telegramjiaoyu.com',
  '/go/telegramtg': 'https://telegramzhfw.com'
};

app.get('/go/:target', (req, res) => {
  const url = redirectMap[req.path];
  if (url) {
    res.redirect(302, url);
  } else {
    res.status(404).send('Not found');
  }
});

// SEOå¼•å¯¼
app.get('*', (req, res) => {
  const isBot = /Googlebot|bingbot|Baiduspider/i.test(req.get('User-Agent'));

  if (isBot) {
    // ä¸ºæœç´¢å¼•æ“è¿”å›ä¼˜åŒ–å†…å®¹
    res.send('<html>...</html>');
  } else {
    // æ™®é€šç”¨æˆ·è·³è½¬
    res.redirect(302, 'https://telegram1688.com');
  }
});

app.listen(3000);
```

### éƒ¨ç½²æ–‡ä»¶ç»“æ„
```
/www/wwwroot/redirect-server/
â”œâ”€â”€ nginx.conf           # Nginxé…ç½®
â”œâ”€â”€ redirect-routes.conf # è·³è½¬è§„åˆ™
â”œâ”€â”€ ip-whitelist.conf    # IPç™½åå•
â””â”€â”€ logs/                # è®¿é—®æ—¥å¿—
```

---

## ğŸ” æœåŠ¡å™¨ 3: ç®¡ç†æœåŠ¡å™¨ (å†…éƒ¨)

### ç”¨é€”
åå°ç®¡ç†ç³»ç»Ÿã€èœ˜è››æ± ã€æ•°æ®åº“ï¼Œä»…å†…ç½‘æˆ–VPNè®¿é—®ã€‚

### é…ç½®è¦æ±‚
- **CPU**: 4æ ¸å¿ƒ
- **å†…å­˜**: 8GB+
- **ç¡¬ç›˜**: 100GB SSD
- **å¸¦å®½**: 3Mbps
- **IP**: å¯ä»¥æ˜¯å…¬ç½‘IPï¼ˆä½†é˜²ç«å¢™ä¸¥æ ¼é™åˆ¶ï¼‰

### éƒ¨ç½²åº”ç”¨
```
apps/admin       â†’ ç«¯å£ 3100 (åå°ç®¡ç†)
spider-pool/     â†’ ç«¯å£ 3200 (èœ˜è››æ± )
PostgreSQL       â†’ ç«¯å£ 5432 (æ•°æ®åº“)
```

### å®‰å…¨é…ç½®

#### 1. é˜²ç«å¢™è§„åˆ™
```bash
# åªå…è®¸æœåŠ¡å™¨1å’ŒæœåŠ¡å™¨2çš„IPè®¿é—®
ufw allow from æœåŠ¡å™¨1_IP to any port 3100
ufw allow from æœåŠ¡å™¨2_IP to any port 3100
ufw allow from ç®¡ç†å‘˜IP to any port 3100

# æ•°æ®åº“åªå…è®¸æœ¬åœ°å’ŒæœåŠ¡å™¨1è®¿é—®
ufw allow from 127.0.0.1 to any port 5432
ufw allow from æœåŠ¡å™¨1_IP to any port 5432

# æ‹’ç»å…¶ä»–æ‰€æœ‰è®¿é—®
ufw default deny incoming
ufw enable
```

#### 2. Nginxåå‘ä»£ç†ï¼ˆæ·»åŠ è®¤è¯ï¼‰
```nginx
server {
    listen 80;
    server_name admin-internal.example.com;

    # åŸºç¡€è®¤è¯
    auth_basic "Admin Access";
    auth_basic_user_file /etc/nginx/.htpasswd;

    # IPç™½åå•
    allow ç®¡ç†å‘˜IP;
    allow åŠå…¬å®¤IPæ®µ;
    deny all;

    location / {
        proxy_pass http://localhost:3100;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

#### 3. VPNè®¿é—®ï¼ˆæ¨èï¼‰
```bash
# ä½¿ç”¨WireGuard VPN
# ç®¡ç†å‘˜é€šè¿‡VPNè¿æ¥åæ‰èƒ½è®¿é—®
# å¯¹å¤–å®Œå…¨ä¸å¼€æ”¾ç«¯å£
```

### ç¯å¢ƒå˜é‡ (.env.production)
```bash
# Nodeç¯å¢ƒ
NODE_ENV=production
PORT=3100

# æ•°æ®åº“ (ä¸»åº“ï¼Œå¯è¯»å†™)
DATABASE_URL="postgresql://admin_user:strong_password@localhost:5432/seo_websites"

# NextAuthé…ç½®
NEXTAUTH_SECRET="your-secret-key"
NEXTAUTH_URL="http://å†…ç½‘IP:3100"

# åŠ å¯†å¯†é’¥
SETTINGS_ENCRYPTION_KEY="your-encryption-key"

# Tavily API (SEOæ•°æ®)
TAVILY_API_KEY="your-tavily-key"

# ä»…ç®¡ç†å‘˜è®¿é—®
ADMIN_ONLY_MODE=true

# å…è®¸çš„å‰ç«¯æœåŠ¡å™¨IP
ALLOWED_FRONTEND_IPS="æœåŠ¡å™¨1_IP,æœåŠ¡å™¨2_IP"
```

---

## ğŸ”— æœåŠ¡å™¨é—´é€šä¿¡

### é€šä¿¡æ¶æ„
```
æœåŠ¡å™¨1 (ç½‘é¡µ) â†â†’ æœåŠ¡å™¨3 (API/æ•°æ®åº“)
       â†“
    é€šè¿‡å†…ç½‘IP
    æˆ–VPNé€šé“
       â†“
å®‰å…¨çš„APIè°ƒç”¨
```

### APIå®‰å…¨æªæ–½

#### 1. æœåŠ¡å™¨1è°ƒç”¨æœåŠ¡å™¨3çš„API
```typescript
// apps/website-1/lib/api-client.ts
const API_BASE = process.env.NEXT_PUBLIC_API_URL; // http://å†…ç½‘IP:3100/api
const API_SECRET = process.env.API_SECRET_KEY;    // æœåŠ¡å™¨é—´å…±äº«å¯†é’¥

async function fetchFromAdmin(endpoint: string) {
  const response = await fetch(`${API_BASE}${endpoint}`, {
    headers: {
      'X-API-Secret': API_SECRET,  // éªŒè¯æœåŠ¡å™¨èº«ä»½
      'X-Server-ID': 'website-1'   // æ ‡è¯†æ¥æº
    }
  });
  return response.json();
}
```

#### 2. æœåŠ¡å™¨3éªŒè¯è¯·æ±‚æ¥æº
```typescript
// apps/admin/middleware.ts
import { NextResponse } from 'next/server';

export function middleware(request: NextRequest) {
  const apiSecret = request.headers.get('X-API-Secret');
  const clientIP = request.headers.get('X-Real-IP');

  const allowedIPs = process.env.ALLOWED_FRONTEND_IPS?.split(',') || [];

  // éªŒè¯APIå¯†é’¥
  if (apiSecret !== process.env.API_SECRET_KEY) {
    return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });
  }

  // éªŒè¯IPç™½åå•
  if (!allowedIPs.includes(clientIP)) {
    return NextResponse.json({ error: 'IP not allowed' }, { status: 403 });
  }

  return NextResponse.next();
}
```

---

## ğŸ“¦ éƒ¨ç½²æ­¥éª¤

### æœåŠ¡å™¨ 1 éƒ¨ç½²

```bash
# 1. å…‹éš†ä»£ç 
cd /www/wwwroot
git clone <repo-url> seo-websites-server1
cd seo-websites-server1

# 2. é…ç½®ç¯å¢ƒå˜é‡
cp .env.server1.example .env.production
nano .env.production  # ç¼–è¾‘é…ç½®

# 3. å®‰è£…ä¾èµ–
pnpm install

# 4. æ„å»ºåº”ç”¨
pnpm build

# 5. ä½¿ç”¨ ecosystem.server1.config.js å¯åŠ¨
pm2 start ecosystem.server1.config.js
pm2 save
```

### æœåŠ¡å™¨ 2 éƒ¨ç½²

```bash
# æ–¹æ¡ˆA: Nginxé…ç½®
cp nginx.redirect.conf /etc/nginx/sites-available/redirect
ln -s /etc/nginx/sites-available/redirect /etc/nginx/sites-enabled/
nginx -t && nginx -s reload

# æ–¹æ¡ˆB: Node.jsåº”ç”¨
cd /www/wwwroot/redirect-server
npm install
pm2 start redirect-app.js
```

### æœåŠ¡å™¨ 3 éƒ¨ç½²

```bash
# 1. å…‹éš†ä»£ç 
cd /www/wwwroot
git clone <repo-url> seo-websites-server3
cd seo-websites-server3

# 2. é…ç½®ç¯å¢ƒå˜é‡
cp .env.server3.example .env.production
nano .env.production  # ç¼–è¾‘é…ç½®

# 3. è®¾ç½®é˜²ç«å¢™
ufw allow from æœåŠ¡å™¨1_IP to any port 3100
ufw allow from æœåŠ¡å™¨2_IP to any port 3100
ufw default deny incoming
ufw enable

# 4. å®‰è£…ä¾èµ–å’Œæ„å»º
pnpm install
pnpm build

# 5. å¯åŠ¨æœåŠ¡
pm2 start ecosystem.server3.config.js
pm2 save
```

---

## ğŸ” èœ˜è››æ± ç³»ç»Ÿæ¶æ„

### èœ˜è››æ± åŠŸèƒ½
1. **è‡ªåŠ¨æ”¶å½•**: å°†ç½‘ç«™URLæäº¤åˆ°å„å¤§æœç´¢å¼•æ“
2. **å¤–é“¾å»ºè®¾**: åœ¨é«˜æƒé‡ç«™ç‚¹å‘å¸ƒå¤–é“¾
3. **å¿«é€Ÿç´¢å¼•**: åŠ é€Ÿæœç´¢å¼•æ“æ”¶å½•
4. **ç›‘æ§ç»Ÿè®¡**: è·Ÿè¸ªæ”¶å½•æƒ…å†µ

### èœ˜è››æ± éƒ¨ç½² (æœåŠ¡å™¨3)

```
/www/wwwroot/spider-pool/
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ search-engines.json  # æœç´¢å¼•æ“é…ç½®
â”‚   â””â”€â”€ submit-urls.json     # å¾…æäº¤URLåˆ—è¡¨
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ submit-baidu.js      # ç™¾åº¦æäº¤
â”‚   â”œâ”€â”€ submit-google.js     # Googleæäº¤
â”‚   â””â”€â”€ check-index.js       # æ£€æŸ¥æ”¶å½•
â””â”€â”€ logs/                    # æäº¤æ—¥å¿—
```

#### ç™¾åº¦èœ˜è››æäº¤è„šæœ¬
```javascript
// spider-pool/scripts/submit-baidu.js
const axios = require('axios');

const BAIDU_SUBMIT_API = 'http://data.zz.baidu.com/urls';
const SITE = 'telegram1688.com';
const TOKEN = 'your-baidu-token';

async function submitToBaidu(urls) {
  const response = await axios.post(
    `${BAIDU_SUBMIT_API}?site=${SITE}&token=${TOKEN}`,
    urls.join('\n'),
    {
      headers: { 'Content-Type': 'text/plain' }
    }
  );
  console.log('ç™¾åº¦æäº¤ç»“æœ:', response.data);
}

// ä»æ•°æ®åº“è·å–å¾…æäº¤URL
const urlsToSubmit = [
  'https://telegram1688.com/',
  'https://telegram1688.com/download',
  // ... æ›´å¤šURL
];

submitToBaidu(urlsToSubmit);
```

#### PM2å®šæ—¶ä»»åŠ¡
```javascript
// ecosystem.server3.config.js
module.exports = {
  apps: [
    {
      name: 'spider-pool-baidu',
      script: 'spider-pool/scripts/submit-baidu.js',
      cron_restart: '0 */6 * * *',  // æ¯6å°æ—¶è¿è¡Œä¸€æ¬¡
      autorestart: false
    },
    {
      name: 'spider-pool-google',
      script: 'spider-pool/scripts/submit-google.js',
      cron_restart: '30 */6 * * *',  // æ¯6å°æ—¶è¿è¡Œä¸€æ¬¡
      autorestart: false
    }
  ]
};
```

---

## ğŸ›¡ï¸ å®‰å…¨æœ€ä½³å®è·µ

### 1. ç½‘ç»œéš”ç¦»
- æœåŠ¡å™¨1: å…¬ç½‘å®Œå…¨å¼€æ”¾ï¼Œä»…æä¾›åªè¯»æ•°æ®
- æœåŠ¡å™¨2: å…¬ç½‘å¼€æ”¾ï¼Œä½†æœ‰ä¸¥æ ¼è¿‡æ»¤
- æœåŠ¡å™¨3: ä»…å†…ç½‘è®¿é—®ï¼Œæˆ–é€šè¿‡VPN

### 2. æ•°æ®åº“å®‰å…¨
```bash
# æœåŠ¡å™¨3çš„PostgreSQLé…ç½®
# /etc/postgresql/*/main/pg_hba.conf

# åªå…è®¸æœ¬åœ°å’ŒæœåŠ¡å™¨1è®¿é—®
host    seo_websites    readonly_user    æœåŠ¡å™¨1_IP/32    md5
host    seo_websites    admin_user       127.0.0.1/32     md5
```

### 3. å¯†é’¥ç®¡ç†
- æ¯ä¸ªæœåŠ¡å™¨ä½¿ç”¨ä¸åŒçš„ NEXTAUTH_SECRET
- API_SECRET_KEY ä»…æœåŠ¡å™¨1å’ŒæœåŠ¡å™¨3çŸ¥é“
- å®šæœŸè½®æ¢å¯†é’¥

### 4. æ—¥å¿—ç›‘æ§
```bash
# è®¾ç½®æ—¥å¿—å‘Šè­¦
pm2 install pm2-logrotate
pm2 set pm2-logrotate:max_size 50M
pm2 set pm2-logrotate:retain 7

# ç›‘æ§å¯ç–‘è®¿é—®
tail -f /var/log/nginx/access.log | grep -E "404|500|401"
```

---

## ğŸ“Š ç›‘æ§å’Œç»´æŠ¤

### æ€§èƒ½ç›‘æ§
```bash
# æœåŠ¡å™¨1: ç›‘æ§ç½‘ç«™å“åº”æ—¶é—´
pm2 monit

# æœåŠ¡å™¨2: ç›‘æ§è·³è½¬æˆåŠŸç‡
tail -f /var/log/nginx/access.log | grep "302"

# æœåŠ¡å™¨3: ç›‘æ§æ•°æ®åº“å’Œåå°
pm2 logs admin
```

### å®šæœŸç»´æŠ¤ä»»åŠ¡
```bash
# æ¯å¤©å¤‡ä»½æ•°æ®åº“ (æœåŠ¡å™¨3)
0 2 * * * /usr/bin/pg_dump seo_websites > /backup/db-$(date +\%Y\%m\%d).sql

# æ¯å‘¨æ¸…ç†æ—¥å¿—
0 0 * * 0 find /www/wwwlogs -name "*.log" -mtime +7 -delete

# æ¯æœˆæ£€æŸ¥æ›´æ–°
0 0 1 * * cd /www/wwwroot/seo-websites-server1 && git pull && pnpm build && pm2 restart all
```

---

## ğŸ¯ ä¼˜åŠ¿æ€»ç»“

### 1. å®‰å…¨æ€§æå‡
- âœ… ç®¡ç†åå°ä¸å…¬å¼€ç½‘ç«™å®Œå…¨éš”ç¦»
- âœ… æ•°æ®åº“ä¸ç›´æ¥æš´éœ²åœ¨å…¬ç½‘
- âœ… å¤šå±‚é˜²æŠ¤ï¼Œé™ä½è¢«æ”»å‡»é£é™©

### 2. SEOä¼˜åŒ–
- âœ… æœåŠ¡å™¨2æä¾›å¹²å‡€çš„SEOå¼•å¯¼
- âœ… éšè—çœŸå®æœåŠ¡å™¨ç»“æ„
- âœ… æœç´¢å¼•æ“çœ‹åˆ°çš„æ˜¯ä¼˜åŒ–åçš„å†…å®¹

### 3. æ€§èƒ½ä¼˜åŒ–
- âœ… æœåŠ¡å™¨1ä¸“æ³¨å‰ç«¯æ¸²æŸ“ï¼Œå“åº”å¿«
- âœ… æœåŠ¡å™¨3ç‹¬äº«èµ„æºï¼Œåå°æ“ä½œä¸å—å½±å“
- âœ… å¯ç‹¬ç«‹æ‰©å±•æ¯ä¸ªæœåŠ¡å™¨

### 4. çµæ´»æ€§
- âœ… å¯ä»¥éšæ—¶æ›´æ¢è·³è½¬è§„åˆ™
- âœ… å¯ä»¥æ·»åŠ /åˆ é™¤åŸŸåè€Œä¸å½±å“å…¶ä»–æœåŠ¡å™¨
- âœ… èœ˜è››æ± ç‹¬ç«‹è¿è¡Œï¼Œä¸å¹²æ‰°ä¸»ä¸šåŠ¡

---

## ğŸ“ ä¸‹ä¸€æ­¥

1. **ç¡®è®¤æœåŠ¡å™¨IPåœ°å€**
   - æœåŠ¡å™¨1 IP: _______
   - æœåŠ¡å™¨2 IP: _______
   - æœåŠ¡å™¨3 IP: _______

2. **åˆ›å»ºé…ç½®æ–‡ä»¶**
   - [ ] ecosystem.server1.config.js
   - [ ] ecosystem.server3.config.js
   - [ ] nginx.redirect.conf (æœåŠ¡å™¨2)

3. **é…ç½®åŸŸåDNS**
   - [ ] 15ä¸ªç½‘ç«™åŸŸå â†’ æœåŠ¡å™¨1 IP
   - [ ] è·³è½¬åŸŸå â†’ æœåŠ¡å™¨2 IP
   - [ ] ç®¡ç†åŸŸå â†’ æœåŠ¡å™¨3 IP (æˆ–ä¸è§£æ)

4. **æµ‹è¯•é€šä¿¡**
   - [ ] æœåŠ¡å™¨1èƒ½è®¿é—®æœåŠ¡å™¨3 API
   - [ ] æœåŠ¡å™¨2èƒ½æ­£ç¡®è·³è½¬åˆ°æœåŠ¡å™¨1
   - [ ] ç®¡ç†åå°åªèƒ½ä»æŒ‡å®šIPè®¿é—®

---

**æ–‡æ¡£åˆ›å»ºæ—¶é—´**: 2025-11-14
**æ¶æ„ç‰ˆæœ¬**: v1.0
